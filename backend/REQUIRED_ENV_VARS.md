# Required Environment Variables for Railway

## ‚úÖ Currently Set (Based on Your Screenshot)

```bash
NODE_ENV=production
JWT_SECRET=<redacted>
API_PREFIX=<redacted>
LOG_LEVEL=<redacted>
OAUTH_CLIENT_ID=<redacted>
OAUTH_CLIENT_SECRET=<redacted>
JWT_EXPIRES_IN=<redacted>
RATE_LIMIT_TTL=<redacted>
```

## ‚ùå MISSING - Required for Full Functionality

### üî¥ Critical: OpenAI API Key (Required for Plan Analysis)

```bash
OPENAI_API_KEY=sk-proj-...
```

**Without this, you'll see:**
```
Error: No analysis response from OpenAI
```

**To get an API key:**
1. Go to https://platform.openai.com/api-keys
2. Create a new API key
3. Add it to Railway Variables as `OPENAI_API_KEY`
4. Value should start with `sk-proj-` or `sk-`

**Cost:** OpenAI charges per API call (~$0.01-0.10 per plan page depending on GPT-4 Vision usage)

---

### üü° Optional but Recommended: Redis (For Background Job Processing)

```bash
# Option 1: Add Redis service in Railway (auto-configures)
# Railway will automatically set REDIS_URL

# Option 2: Manual configuration
REDIS_HOST=redis.railway.internal
REDIS_PORT=6379
REDIS_PASSWORD=<auto-generated>
```

**Without this:**
- Jobs are created but not processed automatically
- You'll see: `‚ö†Ô∏è Job queue not available - jobs will be processed synchronously`

**To add Redis:**
1. In Railway, click "New" ‚Üí "Database" ‚Üí "Redis"
2. Railway automatically links it to your backend
3. Jobs will process in background

---

### üü° Optional: Wasabi S3 Storage (For Production File Storage)

```bash
WASABI_ENDPOINT=https://s3.wasabisys.com
WASABI_REGION=us-east-1
WASABI_ACCESS_KEY_ID=<your-key>
WASABI_SECRET_ACCESS_KEY=<your-secret>
WASABI_BUCKET_NAME=plantakeoff-files
```

**Without this:**
- Files are stored in `/tmp/plantakeoff-storage` (local container storage)
- Files are lost when container restarts
- Works fine for testing/development

**With this:**
- Files persist in cloud storage
- Better for production use
- Wasabi is cheaper than AWS S3

---

## üîß Quick Fix for Current Error

**The immediate issue:** `OPENAI_API_KEY` is not set

### Add it to Railway:

1. Go to Railway Dashboard
2. Select your backend service
3. Click **"Variables"** tab
4. Click **"New Variable"**
5. Add:
   - **Name:** `OPENAI_API_KEY`
   - **Value:** Your OpenAI API key (starts with `sk-`)
6. Save and redeploy

### Verify it works:

After redeployment, check logs for:
```
‚úÖ OpenAI analysis completed: X rooms, Y walls, Z fixtures
```

Instead of:
```
‚ùå No analysis response from OpenAI
```

---

## üß™ Testing Without OpenAI (Optional)

If you want to test the system without spending money on OpenAI API calls:

```bash
VISION_ALLOW_MOCK=true
```

This will return mock/dummy data instead of calling OpenAI.

---

## üìã Environment Variables Checklist

- [x] `NODE_ENV=production`
- [x] `JWT_SECRET` 
- [x] `MINIMAL_START='false'` (in nixpacks.toml)
- [x] `DATABASE_URL` (auto-set by Railway PostgreSQL)
- [ ] **`OPENAI_API_KEY`** ‚Üê **Add this to fix current error!**
- [ ] `REDIS_URL` (optional - add Redis service)
- [ ] `WASABI_*` variables (optional - for production)

---

## üöÄ Priority

**To get the app working right now:**

1. **Add `OPENAI_API_KEY`** ‚Üê Most important!
2. Redeploy or wait for auto-redeploy
3. Test "Start Analysis" button

**For full production functionality:**

1. Add Redis service (for background jobs)
2. Add Wasabi credentials (for persistent storage)
3. Done! üéâ

